<html>

<!-- Mirrored from thefullsnack.com/posts/rust-linux.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 May 2020 03:20:29 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf8" /><!-- /Added by HTTrack -->
<head>
<title>Cài đặt Rust trên Arch Linux | Huy's Blog</title>
<meta charset="utf-8">
<meta http-equiv="content-type" content="text/html;"><meta name=viewport content="initial-scale=1.0 maximum-scale=1.0">
<meta property='og:image' content='../img/default.jpg'>
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="manifest" href="../manifest.json">
<link rel="mask-icon" href="../safari-pinned-tab.svg" color="#5bbad5">
<meta name="theme-color" content="#ffffff">
<link href="../css/theme.dist.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="../emoji/css/emoji.dist.css">
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Space+Mono:400,700&amp;display=swap&amp;subset=vietnamese" rel="stylesheet">

<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92158965-1"></script>
<script>
	       window.dataLayer = window.dataLayer || [];
	       function gtag(){dataLayer.push(arguments);}
	       gtag('js', new Date());

	       gtag('config', 'UA-92158965-1');
	      </script>
</head>
<body lang="en" class="post">
<div class="header lightweight-theme">
<a href="../index.html"><span class="avatar"></span></a>
</div>
<div class="container">
<div class="main">
<h1><span>Cài đặt Rust trên Arch Linux</span></h1>
<p>Việc cài đặt Rust trên môi trường Arch Linux khá là đơn giản. <strong>pacman</strong> có sẵn gói <a href="https://www.archlinux.org/packages/?name=rust"><code>rust</code></a> và <a href="https://www.archlinux.org/packages/?name=cargo"><code>cargo</code></a>, bạn có thể chọn cách cài đặt trực tiếp 2 packages này.</p>
<p>Tuy nhiên ở bước cài đặt công cụ hỗ trợ cho các IDE, chúng ta thường dùng <a href="#"><code>racer</code></a> và engine này yêu cầu chúng ta phải có source code của Rust nằm sẵn trong máy. Nếu chọn cách cài đặt từng gói, thì chúng ta có thể cài đặt Rust source code thông qua <strong>yaourt</strong> với gói <a href="https://aur.archlinux.org/packages/rust-src/"><code>rust-src</code></a><sup><code>AUR</code></sup>, rồi phải set biến môi trường <code>RUST_SRC_PATH</code> khá là phiền phức.</p>
<p>Cho nên, cách cài đặt đơn giản nhất đó là dùng <a href="https://www.archlinux.org/packages/?name=rustup"><code>rustup</code></a>. Package này gồm có: <code>rustup</code>, <code>rustc</code> và <code>cargo</code>. Và bước cài đặt Rust source cũng đơn giản hơn.</p>
<p>Các bước cài đặt cụ thể như sau:</p>
<h2><a href="#cài-rustup" aria-hidden="true" class="anchor" id="cài-rustup"></a>Cài Rustup</h2>
<p>Cài <code>rustup</code> thông qua <code>pacman</code> sau đó chọn phiên bản Rust cần dùng, ví dụ ở đây dùng bản stable.</p>
<pre><code>$ sudo pacman -S rustup
$ rustup default stable
</code></pre>
<p>Sau khi cài xong thì chúng ta có toàn bộ các công cụ cần thiết để làm việc với rust. Có thể kiểm tra thông qua các lệnh:</p>
<pre><code>$ rustc -V
$ cargo -V
</code></pre>
<h2><a href="#cài-đặt-công-cụ-hỗ-trợ-cho-các-ide" aria-hidden="true" class="anchor" id="cài-đặt-công-cụ-hỗ-trợ-cho-các-ide"></a>Cài đặt công cụ hỗ trợ cho các IDE</h2>
<p>Việc đầu tiên cần làm trước khi cài đặt các gói hỗ trợ cho IDE là add Rust source code vào máy, thực hiện việc này thông qua <code>rustup</code> như sau:</p>
<pre><code>$ rustup component add rust-src
</code></pre>
<p>Sau khi đã có source code của Rust trong máy, các bạn có thể bắt đầu đọc source để hiểu những gì Rust làm bên dưới, từ đó sẽ nắm được toàn bộ kiến thức và không cần dùng bất cứ trình hỗ trợ nào cho IDE khi code Rust nữa... à nhầm, không phải =)))) bước tiếp theo là cài đặt <a href="https://github.com/phildawes/racer"><code>racer</code></a>.</p>
<pre><code>$ cargo install racer
</code></pre>
<p>Cuối cùng, tùy theo IDE/editor mà bạn sử dụng, bạn có thể cài các plugin khác nhau cho việc support Rust. Nếu bạn xài Vim thì cài plugin <a href="https://github.com/rust-lang/rust.vim"><code>rust.vim</code></a>:</p>
<pre><code>Plug 'rust-lang/rust.vim'
</code></pre>
<h2><a href="#cài-đặt-syntastic-trong-vim" aria-hidden="true" class="anchor" id="cài-đặt-syntastic-trong-vim"></a>Cài đặt Syntastic trong Vim</h2>
<p>Phần này chỉ là phụ, dành cho bạn nào xài Vim và muốn có chức năng kiểm tra lỗi trực tiếp trong lúc code bằng <code>Syntastic</code>.</p>
<p>Cài thêm plugin <code>Syntastic</code> như sau:</p>
<pre><code>Plug 'vim-syntastic/syntastic'
</code></pre>
<p>Cấu hình cho <code>Syntastic</code> trong <code>.vimrc</code> theo như recommend trên trang chủ dự án của họ:</p>
<pre><code>set statusline+=\ %#warningmsg#
set statusline+=\ %{SyntasticStatuslineFlag()}
set statusline+=\ %*

let g:syntastic_always_populate_loc_list = 1
let g:syntastic_auto_loc_list = 1
let g:syntastic_check_on_open = 1
let g:syntastic_check_on_wq = 0

</code></pre>
<p>Tuy nhiên nếu chỉ đến đây, khả năng là chức năng kiểm tra lỗi vẫn chưa hoạt động được, cần thêm vào dòng sau để chỉ định Syntastic checker dành cho Rust:</p>
<pre><code>let g:syntastic_rust_checkers = ['rustc']
</code></pre>
<p>Khởi động lại Vim và thưởng thức thành quả :D</p>
<p>Đến đây thì việc cài đặt hoàn tất. Bạn có thể tham khảo thêm <a href="https://wiki.archlinux.org/index.php/Rust">wiki của Arch Linux</a> để biết thêm chi tiết về cách cài đặt Rust và các chức năng cần thiết khác.</p>
<p><strong>UPDATE:</strong> Sau khi làm việc với Rust theo như setup ở trên vài ngày thì mình có gặp hai vấn đề liên quan đến <code>cargo</code>, đó là:</p>
<ul>
<li><code>Syntastic</code> không thể nhận biết được project dạng <strong>library</strong>, nên sẽ luôn xuất hiện thông báo kiểu như <code>missing main function</code></li>
<li>Khi sử dụng các <code>crate</code> bên ngoài thì <code>Syntastic</code> sẽ báo lỗi ngay dòng <code>extern crate ...</code>, nói là không tìm thấy crate này</li>
</ul>
<p>Hai vấn đề trên buộc lòng chúng ta phải sử dụng <code>cargo</code> làm checker cho <code>Syntastic</code> thay vì <code>rustc</code>, hiện tại thì <code>cargo check</code> đã được merge vào master của <code>cargo</code> nhưng việc support này vẫn chưa được merge vào plugin <code>rust.vim</code> (xem pull request <a href="https://github.com/rust-lang/rust.vim/pull/132">rust.vim#132</a>).</p>
<p>Cách giải quyết tạm thời là cài <code>rust.vim</code> trực tiếp từ repo của tác giả <strong>jlevesy</strong> thay vì từ repo của <strong>rust-lang</strong>:</p>
<pre><code>Plug 'jlevesy/rust.vim'
</code></pre>
<p>Và chỉ định <code>cargo</code> làm checker:</p>
<pre><code>let g:syntastic_rust_checkers = ['cargo']
</code></pre>
<div class='other-tags'><b>Tags:</b> <a class='topic-tag' href='../tags/rust.html'>rust</a><a class='topic-tag' href='../tags/linux.html'>linux</a><a class='topic-tag' href='../tags/vim.html'>vim</a></div>
<div class="related-posts" style="margin-top: 15px; border-bottom: 1px solid #eee;">
<p><i class="em em-sun_with_face"></i> Cảm ơn bạn đã theo dõi bài viết! các bạn có thể <a href="https://facebook.com/thefullsnackblog" target="_blank">follow mình trên Facebook</a> để đặt câu hỏi, hoặc nhận thông tin về các bài viết mới.</p>
</div>
<div class="comments">
<ul id="comment-list" class="comment-list"></ul>
<div id="login-box" class="login">
Bạn nghĩ như thế nào về bài viết này?<br /><button onclick="login()">Tham gia bình luận</button>
<div class="copyright">Chức năng này cần liên kết với tài khoản Google<br />Nếu không thích thì có thể comment <button onclick="goninja()">Nặc danh</button></div>
</div>
<div id="comment-box" class="comment-input">
<div class="avatar">
<img id="user-avatar" src="#" width="32" height="32" />
</div>
<div class="input">
<textarea id="comment-content" onkeydown="submitComment(event)" placeholder="Comment gõ vào đây :D"></textarea>
<span>Gõ xong nhấn <kbd>Ctrl</kbd> + <kbd>Enter</kbd> để gửi. Bạn không thể xóa comment sau khi gửi.</span>
<button id="comment-button" onclick="submitData()">Gửi</button>
</div>
</div>
</div>
</div>
</div>
<div class="footer lightweight-theme">
 <p>you're free to use the content on this blog for whatever you want</p>
<p>Created with <i class="em em-coffee"></i> <a href="https://github.com/huytd/ristretto-rs">ristretto.rs</a></p>
</div>
<script src="../js/highlight.pack.js"></script>
<script>
        </script>
<script type="text/javascript" async src="../../cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJaxb198.js?config=TeX-MML-AM_CHTML"></script>
<script type="text/x-mathjax-config">
         MathJax.Hub.Config({
             tex2jax: {
                 inlineMath: [['$','$'], ['\\(','\\)']],
                 skipTags: ["script","noscript","style","textarea", "code"],
                 ignoreClass: "tex2jax_ignore|comment|comment-list|content"
             }
         });
        </script>
<script src="../js/toc.js"></script>
<script src="../../www.gstatic.com/firebasejs/3.8.0/firebase.js"></script>
<script>
         let postCommentURL = '../api/post/rust-linux.json';
         // Initialize Firebase
         var config = {
             apiKey: "AIzaSyA1PnIAlJJ-U6iQJMNnCOknBuziBqGMYcY",
             authDomain: "huys-blog-comment.firebaseapp.com",
             databaseURL: "https://huys-blog-comment.firebaseio.com",
             projectId: "huys-blog-comment",
             storageBucket: "huys-blog-comment.appspot.com",
             messagingSenderId: "317330376829"
         };

         var login = function() {
             window.auth.signInWithPopup(provider)
                   .then(function(result) {
                   }).catch(function(err) {
                   });
         };

         var goninja = function() {
             updateAuth({
                 displayName: "Không Tên",
                 photoURL: "https://thefullsnack.com/img/kaonashi.jpg"
             });
         };

         var updateAuth = function(user) {
             if (user) {
                 currentUser = user;
                 // Logged in
                 document.getElementById("login-box").style.display = "none";
                 document.getElementById("comment-box").style.display = "flex";
                 document.getElementById("user-avatar").setAttribute("src", user.photoURL + "?sz=32");
             } else {
                 // Not login yet
                 document.getElementById("comment-box").style.display = "none";
                 document.getElementById("login-box").style.display = "block";
             }
         };

         var encodeHTML = function(s) {
             return s.replace(/</g, '&lt;').replace(/"/g, '&quot;').replace(/>/g, '&gt;');
         };

         var saveNewComment = function(comment) {
             if (!currentUser) {
                 return;
             }
             var commentData = {
                 username: currentUser.displayName,
                 avatar: currentUser.photoURL,
                 post_time: ~~((new Date()).getTime() / 1000),
                 message: encodeHTML(comment)
             };

             fetch(postCommentURL, {
                 method: 'post',
                 headers: {
                     "Content-Type": "application/json"
                 },
                 body: JSON.stringify(commentData)
             }).then((result) => {
                 if (result.status === 200) {
                     addNewComment(commentData.username, commentData.avatar, commentData.post_time, commentData.message);
                 }
             });

             document.getElementById("comment-content").value = "";
         };

         function debounce(func, wait, immediate) {
             var timeout;
             return function() {
                 var context = this, args = arguments;
                 var later = function() {
                     timeout = null;
                     if (!immediate) func.apply(context, args);
                 };
                 var callNow = immediate && !timeout;
                 clearTimeout(timeout);
                 timeout = setTimeout(later, wait);
                 if (callNow) func.apply(context, args);
             };
         };

         var submitData = debounce(function() {
             var comment = document.getElementById("comment-content").value;
             if (comment.length) {
                 saveNewComment(comment);
             }
         }, 250);

         var submitComment = function(e) {
             var keyCode = e.which || e.keyCode;
             var ctrlCode = e.ctrlKey || e.metaKey;
             if (keyCode === 13 && ctrlCode) {
                 submitData();
             }
         };

         var filterNewlineInComment = function(t) {
             return t.replace(/\n/g, "<br/>");
         };

         var filterURLinComment = function(comment) {
             return comment.replace(/(https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/(?:www\.|(?!www))[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9]\.[^\s]{2,})/g, "<a target='_blank' rel='noopener noreferrer' href='$1'>$1</a>");
         };

         var addNewComment = function(user, avatar, time, comment, first) {
             var commentFiltered = encodeHTML(comment);
             commentFiltered = filterNewlineInComment(filterURLinComment(commentFiltered));
             commentFiltered = commentFiltered.replace(/```/g, '');
             var d = new Date(time * 1000);
             var commentTime = d.toLocaleTimeString() + ' ' + d.toLocaleDateString();
             var anoNameClass = (avatar.indexOf('thefullsnack.com') !== -1) ? "grey" : "";
             var html = '<div class="avatar">' +
                        '   <img src="' + avatar + '?sz=32" width="32" height="32"/>' +
                        ' </div>' +
                        '<div class="comment">' +
                        '  <div class="metadata"><b class="' + anoNameClass + '">' + encodeHTML(user) + '</b> lúc <span>' + commentTime + '</span></div>' +
                        '  <div class="content tex2jax_ignore">' + commentFiltered
             '  </div>' +
                        '</div>';
             var li = document.createElement('li');
             li.innerHTML = html;
             if (!first) {
                 document.getElementById("comment-list").append(li);
             } else {
                 let elm = document.getElementById("comment-list");
                 elm.insertBefore(li, elm.firstChild);
             }
         };



         window.onload = function() {

             document.querySelectorAll("pre code").forEach(el => {
                 hljs.highlightBlock(el);
             });

             start_toc_module();

             firebase.initializeApp(config);
             window.provider = new firebase.auth.GoogleAuthProvider();
             window.auth = firebase.auth();
             window.currentUser = null;

             window.auth.onAuthStateChanged(function(user) {
                 updateAuth(user);
             });


             // Fetch comment and put to posts
             fetch(postCommentURL)
                 .then(res => res.json())
                 .then(data => {
                     if (data.comments) {
                         let comments = data.comments;
                         comments.sort((a, b) => a.post_time - b.post_time);
                         for (let i = 0; i < comments.length; i++) {
                             let cmt = comments[i];
                             addNewComment(cmt.username, cmt.avatar, cmt.post_time, cmt.message);
                         }
                     }
                 });
         };

         var toggle_wordwise = function(status) {
             var book = document.querySelector("book");
             var on = document.querySelector("#ww_on");
             var off = document.querySelector("#ww_off");
             if (!status) {
                 book.className = "off";
                 on.className = "btn-toggle";
                 off.className = "btn-toggle active";
             } else {
                 book.className = "";
                 on.className = "btn-toggle active";
                 off.className = "btn-toggle";
             }
         };
        </script>
</body>

<!-- Mirrored from thefullsnack.com/posts/rust-linux.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 May 2020 03:20:30 GMT -->
</html>
